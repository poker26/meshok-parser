#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ—Ä—Ç–æ–≤
# –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —á—Ç–æ –∏–º–µ–Ω–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 3000 –∏ 3001

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ—Ä—Ç–æ–≤..."
echo "================================="

echo "üìä –≠–¢–ê–ü 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ PM2..."
pm2 status

echo ""
echo "üìä –≠–¢–ê–ü 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –Ω–∞ –ø–æ—Ä—Ç–∞—Ö..."
netstat -tlnp | grep -E ":(3000|3001)"

echo ""
echo "üåê –≠–¢–ê–ü 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ—Ä—Ç–∞ 3001 (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä)..."
echo "üìã –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:"
curl -s http://localhost:3001/ | grep -o '<title>.*</title>' || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫"

echo "üìã API health:"
curl -s http://localhost:3001/api/health | head -1

echo ""
echo "üåê –≠–¢–ê–ü 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –ø–æ—Ä—Ç–∞ 3000 (–∫–∞—Ç–∞–ª–æ–≥)..."
echo "üìã –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:"
curl -s http://localhost:3000/ | grep -o '<title>.*</title>' || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫"

echo "üìã API –∫–∞—Ç–∞–ª–æ–≥–∞:"
curl -s http://localhost:3000/api/auctions | head -1

echo ""
echo "üìä –≠–¢–ê–ü 5: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ..."
echo "üìã –ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –ø–æ—Ä—Ç–∞ 3001:"
curl -s http://localhost:3001/ | head -5

echo ""
echo "üìã –ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫ –ø–æ—Ä—Ç–∞ 3000:"
curl -s http://localhost:3000/ | head -5

echo ""
echo "‚úÖ –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê!"
echo "üí° –ï—Å–ª–∏ –æ–±–∞ –ø–æ—Ä—Ç–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –∑–∞–ø—É—Å—Ç–∏—Ç–µ ./fix-catalog-wrong-page.sh"
