# üõ°Ô∏è –ü–ª–∞–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

## üìã –ê–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:**
- **–ü–æ—Ä—Ç—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç**: –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ (3000) vs –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç (3001)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–∞ –∂–µ Supabase –ë–î, —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã
- **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞**: –Ω–æ–≤—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (`catalog-public/`, `logs/`)
- **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –≤–µ—Ä—Å–∏–∏ Node.js –ø–∞–∫–µ—Ç–æ–≤

### ‚ö†Ô∏è **–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏:**
1. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–æ—Ä—Ç–æ–≤** - –µ—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —É–∂–µ —á—Ç–æ-—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 3000/3001
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–π
3. **–§–∞–π–ª—ã** - –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–æ–≤
4. **PM2 –ø—Ä–æ—Ü–µ—Å—Å—ã** - –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º–µ–Ω –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

## üöÄ –ü–ª–∞–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–ë–ï–ó–û–ü–ê–°–ù–û)
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
pm2 status
netstat -tlnp | grep :300

# 2. –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
mkdir -p backup/$(date +%Y%m%d-%H%M%S)
cp -r . backup/$(date +%Y%m%d-%H%M%S)/

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤
ss -tlnp | grep :3000
ss -tlnp | grep :3001
```

### –≠—Ç–∞–ø 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm list --depth=0

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
node -e "console.log(require('./config.js'))"

# 3. –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
node -e "
const { Pool } = require('pg');
const config = require('./config');
const pool = new Pool(config.dbConfig);
pool.query('SELECT 1').then(() => {
  console.log('‚úÖ –ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ OK');
  process.exit(0);
}).catch(err => {
  console.error('‚ùå –ë–î –æ—à–∏–±–∫–∞:', err.message);
  process.exit(1);
});
"
```

### –≠—Ç–∞–ø 3: –ü–æ—ç—Ç–∞–ø–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

#### 3.1. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü (–ë–ï–ó–û–ü–ê–°–ù–û)
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –¥–ª—è –∫–æ–ª–ª–µ–∫—Ü–∏–π (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
node -e "
const { Pool } = require('pg');
const config = require('./config');
const pool = new Pool(config.dbConfig);

async function createTables() {
  try {
    // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫–æ–ª–ª–µ–∫—Ü–∏–π
    await pool.query(\`
      CREATE TABLE IF NOT EXISTS collection_users (
        id SERIAL PRIMARY KEY,
        username VARCHAR(50) UNIQUE NOT NULL,
        email VARCHAR(100) UNIQUE NOT NULL,
        password_hash VARCHAR(255) NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
      )
    \`);
    
    // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π
    await pool.query(\`
      CREATE TABLE IF NOT EXISTS user_collections (
        id SERIAL PRIMARY KEY,
        user_id INTEGER REFERENCES collection_users(id),
        coin_id INTEGER NOT NULL,
        user_condition VARCHAR(10),
        purchase_price DECIMAL(12,2),
        purchase_date DATE,
        notes TEXT,
        predicted_price DECIMAL(12,2),
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
      )
    \`);
    
    console.log('‚úÖ –¢–∞–±–ª–∏—Ü—ã –∫–æ–ª–ª–µ–∫—Ü–∏–π —Å–æ–∑–¥–∞–Ω—ã');
    process.exit(0);
  } catch (err) {
    console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:', err.message);
    process.exit(1);
  }
}

createTables();
"
```

#### 3.2. –ó–∞–ø—É—Å–∫ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
```bash
# –ó–∞–ø—É—Å–∫ –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ä—Ç–∞—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
PORT=3002 node server.js &
PORT=3003 node catalog-server.js &

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
curl http://localhost:3002/api/health
curl http://localhost:3003/api/health

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pkill -f "node server.js"
pkill -f "node catalog-server.js"
```

#### 3.3. –ü–æ–ª–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)
pm2 stop all 2>/dev/null || true

# –ó–∞–ø—É—Å–∫ –Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 start ecosystem.config.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
pm2 status
```

## üîÑ –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞

### –ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫):
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 stop wolmar-main wolmar-catalog
pm2 delete wolmar-main wolmar-catalog

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
cp -r backup/$(ls backup | tail -1)/* .

# 3. –ó–∞–ø—É—Å–∫ —Å—Ç–∞—Ä—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 start [—Å—Ç–∞—Ä—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã]
```

### –ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç:
```bash
# 1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 stop all
pm2 delete all

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ Git
git reset --hard HEAD~1

# 3. –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
npm install --production

# 4. –ó–∞–ø—É—Å–∫ —Å—Ç–∞—Ä—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 start [—Å—Ç–∞—Ä–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è]
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# 1. –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 status

# 2. –õ–æ–≥–∏
pm2 logs --lines 50

# 3. –ü–æ—Ä—Ç—ã
netstat -tlnp | grep :300

# 4. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
curl -I http://localhost:3001
curl -I http://localhost:3000

# 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
node -e "
const { Pool } = require('pg');
const config = require('./config');
const pool = new Pool(config.dbConfig);
pool.query('SELECT COUNT(*) FROM coin_catalog').then(result => {
  console.log('‚úÖ –ö–∞—Ç–∞–ª–æ–≥ –º–æ–Ω–µ—Ç:', result.rows[0].count);
  process.exit(0);
}).catch(err => {
  console.error('‚ùå –û—à–∏–±–∫–∞ –ë–î:', err.message);
  process.exit(1);
});
"
```

## ‚ö†Ô∏è –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### –ß—Ç–æ –ù–ï —Å–ª–æ–º–∞–µ—Ç—Å—è:
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç (–µ—Å–ª–∏ –Ω–∞ –¥—Ä—É–≥–æ–º –ø–æ—Ä—Ç—É)
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤—è—Ç—Å—è –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã (–∫—Ä–æ–º–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö)

### –ß—Ç–æ –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å—Å—è:
- ‚ö†Ô∏è –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç–∞—Ö 3000/3001
- ‚ö†Ô∏è –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç –∏–º–µ–Ω PM2 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- ‚ö†Ô∏è –ï—Å–ª–∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã

## üõ†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º:
1. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª–Ω—ã–π –±—ç–∫–∞–ø** —Å–µ—Ä–≤–µ—Ä–∞
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç—ã** –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ** –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
4. **–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**

### –ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
1. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏** –ø–µ—Ä–≤—ã–µ 30 –º–∏–Ω—É—Ç
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏** –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
3. **–£–±–µ–¥–∏—Ç–µ—Å—å –≤ —Ä–∞–±–æ—Ç–µ** API
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è  
**–†–∏—Å–∫**: üü° –ù–ò–ó–ö–ò–ô (–ø—Ä–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞)  
**–í—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è**: ~10-15 –º–∏–Ω—É—Ç  
**–í—Ä–µ–º—è –æ—Ç–∫–∞—Ç–∞**: ~5 –º–∏–Ω—É—Ç
